<html>
<body>
    <script src="https://js.puter.com/v2/"></script>
    <button id="sign-in">Sign in</button>
    <script>
        // Because signIn() opens a popup window, it must be called from a user action.
        document.getElementById('sign-in').addEventListener('click', async () => {
            // signIn() will resolve when the user has signed in.
            try{
                if(puter.auth.isSignedIn()){
                    puter.auth.signOut();
                }
                let userData = await puter.auth.signIn({"attempt_temp_user_creation":true});
                puter.print('Signed in:<br>' + JSON.stringify(user));
                
                await fetch('http://127.0.0.1:8000/webhook', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                });

                puter.print('UserData posted to webhook');
            }catch(error){
                puter.print('Error:<br>' + JSON.stringify(error));
            }
        });
    </script>
</body>
</html>
