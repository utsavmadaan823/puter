<html>
<body>
    <script src="https://js.puter.com/v2/"></script>
    <script>
        async function fetchPuterToken(){
            try{
                let userData = await puter.auth.signIn({"attempt_temp_user_creation":true});
                puter.print('SUCCESS: Signed in<br>' + JSON.stringify(userData)+'<br><br>');
                const response = await fetch('https://puter-telegram-bot-webhook-proxy.utsavmadaan823.workers.dev/webhook', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                });
                if (response.ok) {
                    puter.print("SUCCESS: Token pushed<br><br>");
                    window.close();
                }else{
                    puter.print("ERROR: Token cannot be pushed - "+response.status+":"+response.statusText+"<br><br>");
                }
            }catch(error){
                puter.print("ERROR: "+error.message+"<br><br>");
            }
        }
        fetchPuterToken();
    </script>
</body>
</html>
